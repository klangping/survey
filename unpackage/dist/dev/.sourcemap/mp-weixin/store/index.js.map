{"version":3,"file":"index.js","sources":["store/index.js"],"sourcesContent":["import http from '../api/http';\n\nexport default {\n  state: {\n    user: null,\n    isAuthenticated: false\n  },\n  \n  // 初始化从本地存储加载状态\n  init() {\n    const user = uni.getStorageSync('user');\n    const token = uni.getStorageSync('token');\n    \n    if (user && token) {\n      this.state.user = user;\n      this.state.isAuthenticated = true;\n    }\n  },\n  \n  // 设置用户信息\n  setUser(userData, token) {\n    this.state.user = userData;\n    this.state.isAuthenticated = true;\n    \n    // 持久化到本地存储\n    uni.setStorageSync('user', userData);\n    uni.setStorageSync('token', token);\n  },\n  \n  // 清除用户信息\n  clearUser() {\n    this.state.user = null;\n    this.state.isAuthenticated = false;\n    \n    uni.removeStorageSync('user');\n    uni.removeStorageSync('token');\n  },\n  \n  // 获取当前用户\n  async fetchCurrentUser() {\n    try {\n      const user = await request.get('/me');\n      this.state.user = user;\n      return user;\n    } catch (error) {\n      this.clearUser();\n      throw error;\n    }\n  }\n};"],"names":["uni"],"mappings":";;AAEA,MAAe,QAAA;AAAA,EACb,OAAO;AAAA,IACL,MAAM;AAAA,IACN,iBAAiB;AAAA,EAClB;AAAA;AAAA,EAGD,OAAO;AACL,UAAM,OAAOA,cAAAA,MAAI,eAAe,MAAM;AACtC,UAAM,QAAQA,cAAAA,MAAI,eAAe,OAAO;AAExC,QAAI,QAAQ,OAAO;AACjB,WAAK,MAAM,OAAO;AAClB,WAAK,MAAM,kBAAkB;AAAA,IAC9B;AAAA,EACF;AAAA;AAAA,EAGD,QAAQ,UAAU,OAAO;AACvB,SAAK,MAAM,OAAO;AAClB,SAAK,MAAM,kBAAkB;AAG7BA,kBAAAA,MAAI,eAAe,QAAQ,QAAQ;AACnCA,kBAAAA,MAAI,eAAe,SAAS,KAAK;AAAA,EAClC;AAAA;AAAA,EAGD,YAAY;AACV,SAAK,MAAM,OAAO;AAClB,SAAK,MAAM,kBAAkB;AAE7BA,wBAAI,kBAAkB,MAAM;AAC5BA,wBAAI,kBAAkB,OAAO;AAAA,EAC9B;AAAA;AAAA,EAGD,MAAM,mBAAmB;AACvB,QAAI;AACF,YAAM,OAAO,MAAM,QAAQ,IAAI,KAAK;AACpC,WAAK,MAAM,OAAO;AAClB,aAAO;AAAA,IACR,SAAQ,OAAO;AACd,WAAK,UAAS;AACd,YAAM;AAAA,IACP;AAAA,EACF;AACH;;"}